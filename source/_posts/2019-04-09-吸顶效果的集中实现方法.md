---
title: '三种吸顶效果'
date: 2019-04-09
categories: 前端 # 分类只能有1个
tags: # 标签可以有多个
  - js
  - css
  - 工具类
---

总结的几种吸顶效果实现方案

<!-- more -->

## position:sticky

简介 ： 粘性定位 sticky 相当于相对定位 relative 和固定定位 fixed 的结合；在页面元素滚动过程中，某个元素距离其父元素的距离达到 sticky 粘性定位的要求时；元素的相对定位 relative 效果变成固定定位 fixed 的效果。

使用条件：

- 父元素不能 overflow:hidden 或者 overflow:auto 属性
- 必须指定 top、bottom、left、right 4 个值之一，否则只会处于相对定位
- 父元素的高度不能低于 sticky 元素的高度
- sticky 元素仅在其父元素内生效

```html
<template>
  <div id="app">
    <div class="container">
      <div class="box"></div>
      <div class="header sticky">使用 `position:sticky` 实现</div>
      <div class="box_two"></div>
    </div>
  </div>
</template>
<style>
  .box {
    width: 100%;
    height: 2rem;
    background: #333;
  }
  .box_two {
    width: 100%;
    height: 20rem;
    background: -webkit-linear-gradient(
      top,
      #333333 20%,
      #999999 40%,
      #333333 80%
    );
  }
  .header {
    width: 100%;
    height: 0.4rem;
    text-align: center;
    line-height: 0.4rem;
    background: #999;
    color: #fff;
    font-size: 0.16rem;
  }
  .sticky {
    position: -webkit-sticky;
    position: sticky;
    top: 0;
  }
</style>
```

##

## 使用原生的 `offsetTop` 实现

```html
<template>
  <div class="color_box"></div>
    <div class="title_box" ref="pride_tab_fixed">
      <div class="title" :class="titleFixed == true ? 'isFixed' :''">
        使用原生的 `offsetTop` 实现
      </div>
    </div>
    <div class="color_box_two"></div>
  </div>
</template>
<script>
  data: {
    titleFixed: ''
  },
  mounted() {
    this.init()
  },
  methods: {
    init() {
      window.addEventListener('scroll', this.handleScroll)
    },
    handleScroll () {
      let self = this
      let scrollTop =
        window.pageYOffset ||
        document.documentElement.scrollTop ||
        document.body.scrollTop
      let offsetTop = self.getOffset(self.$refs.pride_tab_fixed)
      self.titleFixed = scrollTop > offsetTop
    },
    getOffset(obj, direction) {
      let offsetL = 0
      let offsetT = 0
      while (obj !== window.document.body && obj !== null) {
        offsetL += obj.offsetLeft
        offsetT += obj.offsetTop
        obj = obj.offsetParent
      }
      if (direction === 'left') {
        return offsetL
      } else {
        return offsetT
      }
    }
  }
</script>

<style>
  .isFixed {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 99;
  }
</style>

```

### getBoundingClientRect().top 来实现

```js
handleScroll () {
    let self = this
    let offsetTop = self.$refs.pride_tab_fixed.getBoundingClientRect().top
    self.titleFixed = offsetTop < 0
  },
```
